{"version":3,"sources":["components/Loading/index.js","service/config.js","service/api/article.js","service/index.js","service/article.js","components/Mask/index.js","components/Arrow/index.js","assets/images/nodata.svg","components/Swiper/index.js","utils.js","containers/Banner/index.js","containers/ArticleList/index.js","containers/Home/index.js","AppRouter.js","serviceWorker.js","index.js"],"names":["Loading","_ref","_ref$loading","loading","rest","Object","E_workspace_welson_github_daily_zhihu_react_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_1___default","a","createElement","assign","className","style","display","api","concat","apiZhuHu","startimage","latest","article","articleDetail","newsinfo","Service","axios","get","date","replace","id","react__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","react__WEBPACK_IMPORTED_MODULE_0___default","n","Mask","Arrow","_ref$className","module","exports","p","timer","formatNumber","number","formatDate","separator","arguments","length","undefined","year","getFullYear","month","getMonth","day","getDate","getLastDate","Date","Swiper","list","_ref$time","time","_ref$current","current","children","objectWithoutProperties","_useState","useState","_useState2","slicedToArray","active","setActive","_useState3","_useState4","timerId","setTimerId","useEffect","setInterval","c","clearTimeout","react_default","map","v","k","key","item","Array","from","onClick","e","stopPropagation","Math","random","BannerList","data","src_components_Swiper","_ref2","react_router_dom","to","src","image","alt","title","ArticleList","substr","stories","images","lastDate","Home","setLoading","bannerList","setBannerList","_useState5","_useState6","articleList","setArticleList","_useState7","_useState8","loadMore","setLoadMore","getArticleList","option","split","join","articleBeforeDate","then","result","_result$data2","toConsumableArray","catch","err","console","log","_result$data","top_stories","appContainer","useRef","loadingData","beforeScrollTop","handleScroll","_e$target","target","scrollTop","clientHeight","scrollHeight","setTimeout","timeEnd","dom","addEventListener","removeEventListener","ref","Fragment","containers_Banner","src_containers_ArticleList","svgNoData","ArticleDetail","lazy","bind","AppRouter","basename","react","fallback","react_router","path","render","props","location","pathname","src_containers_Home","component","Boolean","window","hostname","match","ReactDOM","src_AppRouter","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.ef712d66.chunk.js","sourcesContent":["import React from 'react';\r\nimport './index.scss';\r\n\r\nconst Loading = ({loading=true, ...rest}) => {\r\n  return (\r\n    <div className='loading' {...rest} style={{display: loading ? 'flex' : 'none'}}>\r\n      <span></span>\r\n      <span></span>\r\n      <span></span>\r\n      <span></span>\r\n      <span></span>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Loading;","const config = {\r\n  site: 'https://zhihu-agent.herokuapp.com',\r\n\tmethod: '/get?api='\r\n}\r\n\r\nconst api = ''.concat(config.site, config.method);\r\n\r\nexport { api }","import { api } from '../config';\r\n\r\nconst apiZhuHu = {\r\n  startimage: `${api}/4/start-image/1080*1776`,\r\n\tlatest: `${api}/4/news/latest`, // top数据 和 当天的文章列表 \r\n\tarticle: `${api}/4/news/before/<date>`, // 指定日期前一天的文章列表\r\n\tarticleDetail: `${api}/4/news/<id>`, // 文章详情\r\n\tnewsinfo: `${api}/4/story-extra`,\r\n\t// topics: '/4/themes',\r\n\t// topicbyid: '/4/theme/',\r\n\t// sections: '/3/sections',\r\n\t// sectionbyid: '/3/section',\r\n}\r\n\r\nexport default apiZhuHu;\r\n","import article from './article';\r\n\r\nconst Service = {\r\n  article,\r\n}\r\n\r\nexport default Service","import axios from 'axios';\r\nimport apiZhuHu from './api/article';\r\n\r\nclass articleServer {\r\n  latest() {\r\n    return axios.get(apiZhuHu.latest)\r\n  }\r\n\r\n  // YYYYMMDD\r\n  articleBeforeDate(date) {\r\n    return axios.get(apiZhuHu.article.replace('<date>', date))\r\n  }\r\n\r\n  // \r\n  articleDetail(id) {\r\n    return axios.get(apiZhuHu.articleDetail.replace('<id>', id))\r\n  }\r\n}\r\n\r\nexport default new articleServer();\r\n\r\n\r\n\r\n","import React from 'react';\r\nimport './index.scss';\r\n\r\nconst Mask = () => {\r\n  return (\r\n    <div className='img-mask'></div>\r\n  )\r\n}\r\n\r\nexport default Mask;","import React from 'react';\r\nimport './index.scss';\r\n\r\nconst Arrow = ({ className='', ...rest }) => {\r\n  return (\r\n    <div className={`arrow-img ${className}`} {...rest}></div>\r\n  )\r\n}\r\n\r\nexport default Arrow;","module.exports = __webpack_public_path__ + \"static/media/nodata.2d902be2.svg\";","import React, { useState, useEffect } from 'react';\r\nimport './index.scss'\r\n;\r\n\r\nlet timer;\r\nconst Swiper = ({\r\n  className='', list, time=3000, current=0, children, ...rest\r\n}) => {\r\n  const [active, setActive] = useState(current);\r\n  const [timerId, setTimerId] = useState();\r\n  const length = list.length;\r\n  useEffect(() => {\r\n    timer = setInterval(() => {\r\n      setActive(c => (c + 1) % length)\r\n    }, time);\r\n    return () => clearTimeout(timer)\r\n  }, [time, length, timerId]);\r\n  return (\r\n    <div className={'swiper-container ' + className} {...rest}>\r\n      <div className='swiper-content'>\r\n        {list.map((v,k) => {\r\n          return (\r\n            <div key={k}\r\n              className={`swiper-slide ${active === k ? 'swiper-slide-active': ''}`}\r\n            >\r\n              {children({item: v})}\r\n            </div>\r\n          )\r\n        })}\r\n      </div>\r\n      <div className='swiper-pagination'>\r\n        {Array.from({length}).map((v, k) => {\r\n          return (\r\n            <span \r\n              key={k}\r\n              className={`\r\n                swiper-pagination-dot \r\n                ${active === k ? 'swiper-pagination-dot-active': ''}\r\n              `}\r\n              onClick={(e) => {\r\n                e.stopPropagation();\r\n                clearTimeout(timer)\r\n                setTimerId(Math.random());\r\n                setActive(k)\r\n              }}\r\n            />\r\n          )\r\n        })}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Swiper;","export const formatNumber = (number) => {\r\n  return number > 9 ? number : `0${number}`\r\n}\r\n\r\nexport const formatDate = (date, separator='/') => {\r\n  const year = date.getFullYear();\r\n  const month = formatNumber(date.getMonth() + 1);\r\n  const day = formatNumber(date.getDate());\r\n  return `${year}${separator}${month}${separator}${day}`\r\n}\r\n\r\nexport const getLastDate = (date, day=1) => {\r\n  const dateObj = new Date(new Date(date)*1 - day * 24 * 3600 * 1000);\r\n  return dateObj;\r\n}\r\n\r\nexport const getCacheItem = (key) => {\r\n  let data;\r\n  let strL = localStorage.getItem(key);\r\n  try {\r\n    data = JSON.parse(localStorage.getItem(key));\r\n  } catch (e) {\r\n    data = strL;\r\n  }\r\n  return data;\r\n}\r\n\r\nexport const setCacheItem = (key, value) => {\r\n  localStorage.setItem(key, JSON.stringify(value));\r\n}","import React from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport Swiper from '../../components/Swiper';\r\nimport ImgMask from '../../components/Mask';\r\n\r\nimport './index.scss';\r\n\r\nconst BannerList = ({ data }) => {\r\n  return (\r\n    <Swiper list={data} className='banner-container'>\r\n      {({item}) => (\r\n        <Link to={`/article/${item.id}`}>\r\n          <div className='banner-item'>\r\n            <img src={item.image} alt=\"\"/>\r\n            <span className='item-title'>{item.title}</span>\r\n            <ImgMask />\r\n          </div>\r\n        </Link>\r\n      )}\r\n    </Swiper>\r\n  )\r\n}\r\n\r\nexport default BannerList;","import React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nimport \"./index.scss\";\r\n\r\nconst ArticleList = ({ data }) => {\r\n  return (\r\n    <div className=\"article-list-container\">\r\n      {!!data.length &&\r\n        data.map(v => {\r\n          return (\r\n            <div key={v.date} className=\"list-content\">\r\n              <div className=\"list-date\">\r\n                {v.date.substr(0, 4) +\r\n                  \"/\" +\r\n                  v.date.substr(4, 2) +\r\n                  \"/\" +\r\n                  v.date.substr(6, 2)}\r\n              </div>\r\n              <div className=\"article-list\">\r\n                {v.stories &&\r\n                  v.stories.map(article => (\r\n                    <Link to={`/article/${article.id}`} key={article.id}>\r\n                      <div className=\"article\">\r\n                        <img src={article.images[0]} alt=\"\" />\r\n                        <div className=\"article-info\">{article.title}</div>\r\n                      </div>\r\n                    </Link>\r\n                  ))}\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ArticleList;\r\n","import React, { useState, useEffect, useRef } from \"react\";\r\nimport Service from \"../../service\";\r\nimport { formatDate, getLastDate } from \"../../utils\";\r\nimport Banner from \"../Banner\";\r\nimport ArticleList from \"../ArticleList\";\r\nimport svgNoData from \"../../assets/images/nodata.svg\";\r\nimport Arrow from \"../../components/Arrow\";\r\nimport Loading from \"../../components/Loading\";\r\n\r\nimport \"./index.scss\";\r\n\r\nlet lastDate = formatDate(new Date());\r\n\r\nconst Home = ({ style }) => {\r\n  const [loading, setLoading] = useState(true);\r\n  const [bannerList, setBannerList] = useState([]);\r\n  const [articleList, setArticleList] = useState({});\r\n  const [loadMore, setLoadMore] = useState(false);\r\n\r\n  useEffect(() => {\r\n    Service.article\r\n      .latest()\r\n      .then(result => {\r\n        const { date, stories, top_stories } = result.data;\r\n        setLoading(false);\r\n        setBannerList(top_stories);\r\n        setArticleList([{ date, stories }]);\r\n      })\r\n      .then(() => {\r\n        getArticleList();\r\n      });\r\n  }, []);\r\n\r\n  function getArticleList() {\r\n    setLoadMore(true);\r\n    const option = lastDate.split(\"/\").join(\"\");\r\n    return Service.article\r\n      .articleBeforeDate(option)\r\n      .then(result => {\r\n        lastDate = formatDate(getLastDate(lastDate));\r\n        const { date, stories } = result.data;\r\n        setLoadMore(false);\r\n        setArticleList(list => {\r\n          return [...list, { date, stories }];\r\n        });\r\n      })\r\n      .catch(err => {\r\n        setLoadMore(false);\r\n        console.log(err);\r\n      });\r\n  }\r\n\r\n  const appContainer = useRef(null);\r\n  useEffect(() => {\r\n    let timer; // 防抖\r\n    let loadingData = false; //\r\n    let beforeScrollTop = 0; // 标记滚动方向\r\n    function handleScroll(e) {\r\n      const {\r\n        scrollTop, // 滚动高度\r\n        clientHeight, // 可视高度\r\n        scrollHeight // 容器总高度\r\n      } = e.target;\r\n      if (\r\n        !loadingData &&\r\n        scrollTop > beforeScrollTop &&\r\n        scrollHeight <= scrollTop + clientHeight + 100 * 3\r\n      ) {\r\n        clearTimeout(timer);\r\n        timer = setTimeout(() => {\r\n          beforeScrollTop = scrollTop;\r\n          loadingData = true;\r\n          console.time();\r\n          getArticleList().then(() => {\r\n            console.timeEnd();\r\n            loadingData = false;\r\n          });\r\n        }, 0);\r\n      }\r\n    }\r\n    const dom = appContainer.current;\r\n    dom.addEventListener(\"scroll\", handleScroll);\r\n    return () => dom.removeEventListener(\"scroll\", handleScroll);\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"app-container\" ref={appContainer} style={style}>\r\n      {loading ? (\r\n        <Loading />\r\n      ) : (\r\n        <>\r\n          <Banner data={bannerList} />\r\n          {!!articleList.length ? (\r\n            <ArticleList data={articleList} />\r\n          ) : (\r\n            <div className=\"no-data\">\r\n              <img src={svgNoData} alt=\"\" />\r\n              <p>暂无数据</p>\r\n            </div>\r\n          )}\r\n          <div\r\n            className=\"loadmore-wrapper\"\r\n            style={{ display: loadMore ? \"block\" : \"none\" }}\r\n          >\r\n            <div className=\"loadmore-container\">\r\n              <Arrow />\r\n              <span>下滑查看更多</span>\r\n            </div>\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n","import React, { Suspense, lazy } from 'react';\nimport { BrowserRouter as Router, Route } from 'react-router-dom';\nimport Home from './containers/Home';\nimport Loading from \"./components/Loading\";\n\n\n// React.lazy 和 Suspense 技术还不支持服务端渲染\n// lazy: 懒加载\n// const Home = lazy(() => import('./containers/Home'));\nconst ArticleDetail = lazy(() => import('./containers/ArticleDetail'));\n\n// Suspense: \n// 如果在父组件渲染完成后，子组件（懒加载）的模块还没有被加载完成，我们可以使用 Suspense 加载指示器为此组件做优雅降级。\n\nconst AppRouter = () => (\n  <Router basename=\"/daily-zhihu-react\">\n    <Suspense fallback={<Loading />}>\n        <Route\n          path='/'\n          render={props => {\n            let style = { display: 'block' };\n            if(props.location.pathname !== '/') {\n              style.display = 'none'\n            }\n            return <Home style={style}/>\n          }}\n        />\n        <Route path='/article/:id' component={ArticleDetail} />\n    </Suspense>\n  </Router>\n);\n\nexport default AppRouter;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport AppRouter from './AppRouter';\nimport * as serviceWorker from './serviceWorker';\nimport './assets/style/index.scss';\n\nReactDOM.render(<AppRouter />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}